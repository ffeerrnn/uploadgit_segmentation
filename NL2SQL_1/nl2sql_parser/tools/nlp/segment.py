# -*- coding: utf-8 -*-


"""
   author: LinJie.Xu
   time: 2019/6/12
"""

import jieba

from nl2sql_parser.tools.common.tools import Tools


class Segment:

    def __init__(self, words=None):
        if words is None:
            words = []

        self.indexs = self.index(words)

    def update_index(self, words):
        words = self.transfer_dict(words)
        self.indexs = self.index(words)

    def segment(self, query, lang="zh_CN"):
        def transfer(words): # 把词语转成了组成它的字的列表
            tmp = []
            for word in words:
                if lang == "en_US" or lang == "fr_FR":
                    word = word.replace(
                        ",",
                        " , ").replace(
                        ".",
                        " . ").replace(
                        "，",
                        " ， ")
                    tmp.append(word.strip().split())
                else:
                    tmp.append(list(word))
            return tmp

        if lang == "en_US" or lang == "fr_FR":
            return self.merge_number(self.merge(
                transfer(query.strip().split())), "LIST")
        else:
            tmp11 = self.merge_number(list(jieba.cut(query)))
            tmp0 = transfer(tmp11)
            tmp = self.merge(tmp0)
            return self.merge_number(
                tmp, "LIST")

    @staticmethod
    def index(words):
        index = {}
        for word in words:
            i = 0
            for item in word:
                key = "{}-{}".format(item, i) # 键是字和它的位置，值是所在的词的集合
                index.setdefault(key, set())
                index[key].add(" ".join(word))
                i += 1

        return index

    def merge_number(self, words, mode="STRING"):
        tmp_words = []
        last_status = False

        def is_number(word):
            if mode == "LIST":
                for item in word:
                    if not Tools.is_number(item):
                        return False
            else:
                if not Tools.is_number(word):
                    return False
            return True

        for word in words:
            if is_number(word) or (mode == "LIST" and word in [['.'], [',']]):
                if last_status and tmp_words:
                    if mode == "LIST":
                        tmp_words[-1].extend(word)
                    else:
                        tmp_words[-1] = "{}{}".format(tmp_words[-1], word)
                else:
                    tmp_words.append(word)
                last_status = True
            else:
                tmp_words.append(word)
                last_status = False
        return tmp_words

    def merge(self, words, index=None):
        """
        把分词结果中，合起来是关键词的词语合起来
        :param words:
        :param index:
        :return:
        """
        if index is None:
            index = {}

        if self.indexs:
            index = self.indexs

        ret = []
        last_i = 0
        tmp_word = []
        tmp_set = None
        idx = 0

        for i in range(len(words)):
            for j in range(len(words[i])):
                key = "{}-{}".format(words[i][j], idx)
                # print(key)
                if key not in index:
                    # print('key not in index')
                    if tmp_word:
                        # print('key not in index tmp_word', tmp_word)
                        ret.append(tmp_word)
                        # print('key not in index ret', ret)
                        key = "{}-{}".format(words[i][j], 0)
                        if key in index:
                            tmp_word = [words[i][j]]
                            tmp_set = index[key]
                            idx = 1
                            continue
                        else:
                            tmp_word = []
                            tmp_set = None
                            idx = 0
                    if i != last_i:
                        ret.append([words[i][j]])
                        last_i = i
                    else:
                        if ret:
                            tmp = ret.pop()
                        else:
                            tmp = []
                        tmp.append(words[i][j])
                        ret.append(tmp)
                else:
                    # print('key in index')
                    if tmp_set is None:
                        tmp_set = index[key]
                    else:
                        tmp_set = tmp_set & index[key]
                    if not tmp_set:
                        # print('not tmp_set')
                        ret.append(tmp_word)
                        key = "{}-{}".format(words[i][j], 0)
                        if key in index:
                            tmp_word = [words[i][j]]
                            tmp_set = index[key]
                            idx = 1
                        else:
                            ret.append([words[i][j]])
                            tmp_word = []
                            tmp_set = None
                            idx = 0
                    else:

                        tmp_word.append(words[i][j])
                        # print('tmp_set tmp_word', tmp_word)
                        idx += 1
            last_i = i

        if tmp_word:
            ret.append(tmp_word)

        return ret

    @staticmethod
    def transfer_dict(words): # 把一个词转成组成它的字的列表
        ret = []

        for word in words:
            ret.append(list(word))

        return ret


if __name__ == "__main__":
    nlp = Segment()

    # key_words = [
    #     '最少',
    #     '郑州',
    #     '城镇人口',
    #     '城市',
    #     '贵州',
    #     '安徽',
    #     '呼和浩特',
    #     '最低',
    #     '拉萨',
    #     '最便宜',
    #     '云南',
    #     '青海',
    #     '西安',
    #     '有多少',
    #     '南昌',
    #     '江苏',
    #     '女性人口（万人）',
    #     '山东',
    #     '最没用',
    #     '南京',
    #     '不同',
    #     '武汉',
    #     '最小',
    #     '太原',
    #     '农村人口（万人）',
    #     '河南',
    #     '兰州',
    #     '大于等于',
    #     '=',
    #     '大于',
    #     '最强',
    #     '西宁',
    #     '多少',
    #     '合肥',
    #     '不同数量',
    #     '福建',
    #     '银川',
    #     '平均',
    #     '且',
    #     '乌鲁木齐',
    #     '并且',
    #     '广东',
    #     '至少',
    #     '青岛',
    #     '各个',
    #     '小于',
    #     '最牛',
    #     '湖南',
    #     '长春',
    #     '每个',
    #     '浦东',
    #     '昆明',
    #     '新疆',
    #     '长沙',
    #     '大连',
    #     '上海',
    #     '南宁',
    #     '不等于',
    #     '石家庄',
    #     '宁夏',
    #     '每',
    #     '北京',
    #     '广西',
    #     '或者',
    #     '最贵',
    #     '陕西',
    #     '东城',
    #     '厦门',
    #     '日期',
    #     '西藏',
    #     '福州',
    #     '是',
    #     '黑龙江',
    #     '最高',
    #     '杭州',
    #     '最多',
    #     '省份',
    #     '大',
    #     '计数',
    #     '>',
    #     '小于等于',
    #     '等于',
    #     '甘肃',
    #     '总',
    #     '内蒙古',
    #     '成都',
    #     '济南',
    #     '宁波',
    #     '总数',
    #     '哈尔滨',
    #     '<=',
    #     '贵阳',
    #     '海淀',
    #     '至多',
    #     '人口(万人)',
    #     '河北',
    #     '四川',
    #     '最弱',
    #     '>=',
    #     '浙江',
    #     '!=',
    #     '男性人口（万人）',
    #     '各',
    #     '沈阳',
    #     '去重计数',
    #     '平均数',
    #     '最年轻',
    #     '辽宁',
    #     '数量',
    #     '最老',
    #     '海口',
    #     '<',
    #     '广州',
    #     '平均值',
    #     '求和',
    #     '或',
    #     '山西',
    #     '小',
    #     '海南',
    #     '量',
    #     '江西',
    #     '男女比例',
    #     '湖北',
    #     '吉林',
    #     '最大']
    # key_words = [
    #     '徐蔓楚',
    #     '邱芯',
    #     '万县',
    #     '西北',
    #     '韦君',
    #     '潘磊',
    #     '周柏',
    #     '金乡',
    #     '涂安',
    #     '装运状态',
    #     '袁丽美',
    #     '东丰',
    #     '最年轻',
    #     '盐城',
    #     '-67%',
    #     '鹤壁',
    #     '加格达奇',
    #     '潘健',
    #     '邱荷',
    #     '11%',
    #     '戴立',
    #     '程宁',
    #     '州城',
    #     '程聪',
    #     '库尔勒',
    #     '-63%',
    #     '彭娜',
    #     '沈虢',
    #     '保定',
    #     '赤峰',
    #     '施良',
    #     '常康',
    #     '至少',
    #     '袁岱',
    #     '玉溪',
    #     '夏光',
    #     '华东',
    #     '薛芳',
    #     '平邑',
    #     '栖霞',
    #     '焦作',
    #     '-29%',
    #     '漳州',
    #     '楚杰',
    #     '白栋',
    #     '四川',
    #     '谢丽雪',
    #     '襄樊',
    #     '37%',
    #     '产品名称',
    #     '仙居',
    #     '国家',
    #     '标准级',
    #     '雷菊',
    #     '-47%',
    #     '东北',
    #     '巩光',
    #     '吕君',
    #     '辛置',
    #     '白婵',
    #     '营口',
    #     '36%',
    #     '汉川',
    #     '装订机',
    #     '邱栋',
    #     '销售额',
    #     '罗琼',
    #     '计数',
    #     '萍乡',
    #     '陈婉',
    #     '陶磊',
    #     '梅河口',
    #     '秦乐',
    #     '卢谙',
    #     '顾丹',
    #     '7%',
    #     '蒲圻',
    #     '绥化',
    #     '张掖',
    #     '武明媚',
    #     '邹凤',
    #     '郝绅',
    #     '寒亭',
    #     '冯巧',
    #     '彭丽美',
    #     '罗昌',
    #     '朗乡',
    #     '包头',
    #     '黄娟',
    #     '赵幂',
    #     '胡临耀',
    #     '宣州',
    #     '郑家屯',
    #     '5%',
    #     '石桥',
    #     '南通',
    #     '安阳',
    #     '自贡',
    #     '信宜',
    #     '惠州',
    #     '嘉兴',
    #     '诸暨',
    #     '吴磊',
    #     '庄伟',
    #     '0%',
    #     '烟筒山',
    #     '李雯',
    #     '付荣',
    #     '-83%',
    #     '北碚',
    #     '-170%',
    #     '常松',
    #     '武汉',
    #     '肃州',
    #     '城市',
    #     '郝婷',
    #     '沈阳',
    #     '发货前天数（计划）',
    #     '最便宜',
    #     '北票',
    #     '范立荣',
    #     '-23%',
    #     '恩城',
    #     '巩荷',
    #     '满洲里',
    #     '程安',
    #     '刘乐',
    #     '-25%',
    #     '胡宣',
    #     '杨栋',
    #     '-57%',
    #     '冯娜',
    #     '昌平',
    #     '苏江丽',
    #     '阿城',
    #     '临清',
    #     '枝城',
    #     '沈强',
    #     '孝感',
    #     '陶莞颖',
    #     '卢欢悦',
    #     '许辉',
    #     '海门',
    #     '14%',
    #     '42%',
    #     '陈霖',
    #     '-58%',
    #     '秦芯',
    #     '周木兰',
    #     '-60%',
    #     '唐欢悦',
    #     '-53%',
    #     '黄陂',
    #     '-145%',
    #     '钟丽',
    #     '-65%',
    #     '黄丽',
    #     '抚顺',
    #     '广水',
    #     '开原',
    #     '每笔订单利润',
    #     '上虞',
    #     '苏姝',
    #     '江口',
    #     '义乌',
    #     '丁崆',
    #     '贺升',
    #     '3%',
    #     '陈荷',
    #     '黄康',
    #     '桓仁',
    #     '薛关茵',
    #     '铜川',
    #     '赖芳茵',
    #     '那曲',
    #     '袁丽娜',
    #     '韩婵',
    #     '滕州',
    #     '大',
    #     '消费者',
    #     '邵鹏',
    #     '韦立',
    #     '广州',
    #     '孙雯',
    #     '-340%',
    #     '驻马店',
    #     '十字路',
    #     '谭立',
    #     '肖岱',
    #     '洪梦',
    #     '韩杰',
    #     '-335%',
    #     '安徽',
    #     '济水',
    #     '何娇',
    #     '巩德',
    #     '葛欢',
    #     '贺立',
    #     '亳州',
    #     '兰溪',
    #     '林口',
    #     '衡水',
    #     '南麻',
    #     '最老',
    #     '九台',
    #     '唐凤',
    #     '湖州',
    #     '罗安',
    #     '贺晨',
    #     '巩荣',
    #     '46%',
    #     '毛刚',
    #     '至多',
    #     '贺恒',
    #     '蒙阴',
    #     '佟斯云',
    #     '最少',
    #     '平凉',
    #     '卢伟',
    #     '葛蔓楚',
    #     '应城',
    #     '小于等于',
    #     '吕兰',
    #     '熊临耀',
    #     '戴武',
    #     '低于',
    #     '韶关',
    #     '陶武',
    #     '洪光',
    #     '新石',
    #     '韦松',
    #     '海拉尔',
    #     '河南',
    #     '乌海',
    #     '龙江',
    #     '-13%',
    #     '蛟河',
    #     '泰州',
    #     '且',
    #     '-120%',
    #     '鄱阳',
    #     '百色',
    #     '连然',
    #     '长清',
    #     '昌吉',
    #     '信封',
    #     '林青',
    #     '常光',
    #     '南宁',
    #     '洪江',
    #     '邱丽雪',
    #     '付立',
    #     '明光',
    #     '田黎明',
    #     '-12%',
    #     '姚柏',
    #     '孙诚',
    #     '埠河',
    #     '仙桃',
    #     '-6%',
    #     '用具',
    #     '王立勤',
    #     '涪陵',
    #     '鸡西',
    #     '白鹄',
    #     '段强',
    #     '临汾',
    #     '孔辉',
    #     '河北',
    #     '高邮',
    #     '彭欢',
    #     '阿里河',
    #     '柯巧',
    #     '唐河',
    #     '-341%',
    #     '贾嫒',
    #     '徐杰',
    #     '绥芬河',
    #     '钱宁',
    #     '牛晒明',
    #     '榆林',
    #     '拜泉',
    #     '钟松',
    #     '常熟市',
    #     '珠海',
    #     '郝壁',
    #     '贺斯云',
    #     '量',
    #     '乐山',
    #     '丁娇',
    #     '邓州',
    #     '叶柏寿',
    #     '昌图',
    #     '邹伟',
    #     '林谦',
    #     '上海',
    #     '宋良',
    #     '曹柏',
    #     '求和',
    #     '沙市',
    #     '毕节',
    #     '25%',
    #     '陶恒',
    #     '杨柳青',
    #     '韩城',
    #     '徐婵',
    #     '巩关茵',
    #     '倪芬',
    #     '南台',
    #     '廖宣',
    #     '22%',
    #     '友好',
    #     '万达侠',
    #     '薛荷',
    #     '-123%',
    #     '马丽娜',
    #     '冷水江',
    #     '洮南',
    #     '平阴',
    #     '麦虹',
    #     '秦淑芳',
    #     '-195%',
    #     '菏泽',
    #     '34%',
    #     '昭通',
    #     '罗婵',
    #     '新民',
    #     '袁敬',
    #     '双阳',
    #     '兰西',
    #     '台城',
    #     '巢湖',
    #     '巩辉',
    #     '铜仁',
    #     '邓珊',
    #     '蔡甸',
    #     '殷崆',
    #     '南平',
    #     '洪辉',
    #     '系固件',
    #     '潘惠',
    #     '八步',
    #     '北海',
    #     '各个',
    #     '郸城',
    #     '新野',
    #     '33%',
    #     '楚丽丽',
    #     '叶立勤',
    #     '曹琼',
    #     '当日',
    #     '-98%',
    #     '大同',
    #     '廉州镇',
    #     '常明媚',
    #     '冯乐',
    #     '南票',
    #     '吉舒',
    #     '谭君',
    #     '衢州',
    #     '龙锦',
    #     '漯河',
    #     '施莲',
    #     '薛健',
    #     '苏州',
    #     '康青',
    #     '48%',
    #     '合德',
    #     '雄州',
    #     '咸宁',
    #     '浦城',
    #     '-315%',
    #     '嘉善',
    #     '二级',
    #     '-37%',
    #     '樊彩',
    #     '潘锦',
    #     '利润率',
    #     '武杰',
    #     '等于',
    #     '<',
    #     '邱廉',
    #     '殷涛',
    #     '马雯',
    #     '涂珑',
    #     '-17%',
    #     '-156%',
    #     '开化',
    #     '-251%',
    #     '孙梦',
    #     '平度',
    #     '黄山',
    #     '吉林市',
    #     '潼川',
    #     '-32%',
    #     '龙谦',
    #     '麦忠',
    #     '廉洲',
    #     '-105%',
    #     '林廉',
    #     '倪幂',
    #     '王丹',
    #     '一级',
    #     '宣化',
    #     '卢淑芳',
    #     '江苏',
    #     '-210%',
    #     '曲靖',
    #     '麦磊',
    #     '2%',
    #     '佘丽',
    #     '蒋雯',
    #     '钟虹',
    #     '葛彩',
    #     '邹雯',
    #     '施黎明',
    #     '潘博',
    #     '-240%',
    #     '乌达',
    #     '马晨',
    #     '宿州',
    #     '荆州',
    #     '不同数量',
    #     '三明',
    #     '常崆',
    #     '孙斯云',
    #     '邱博',
    #     '-48%',
    #     '邮寄方式',
    #     '-80%',
    #     '-44%',
    #     '莎车',
    #     '刘明',
    #     '冯丽',
    #     '桦甸',
    #     '黄磊',
    #     '最均衡',
    #     '戴珑',
    #     '宝山',
    #     '利润',
    #     '潮州',
    #     '巩嘉丽',
    #     '定州',
    #     '林丹',
    #     '-395%',
    #     '郝廉',
    #     '赵升',
    #     '肖保',
    #     '无城',
    #     '兖州',
    #     '河源',
    #     '宽甸',
    #     '姚秋',
    #     '-246%',
    #     '兰州',
    #     '龙娜',
    #     '贺丹',
    #     '<=',
    #     '白银',
    #     '每',
    #     '宜城',
    #     '佟丽娜',
    #     '芜湖',
    #     '蒋宣',
    #     '涂伟',
    #     '43%',
    #     '潘盛',
    #     '南京',
    #     '邹实',
    #     '温州',
    #     '钱婵娟',
    #     '鞍山',
    #     '-75%',
    #     '龙凤',
    #     '赖虎',
    #     '每个',
    #     '毛庆缘',
    #     '云南',
    #     '合川',
    #     '曹丽',
    #     '柯丽',
    #     '张家港',
    #     '鱼洞',
    #     '公司',
    #     '夏明媚',
    #     '戴松',
    #     '即墨',
    #     '平顶山',
    #     '徐伟',
    #     '余姚',
    #     '何根基',
    #     '-220%',
    #     '陈健',
    #     '岳阳',
    #     '曾辉',
    #     '石龙',
    #     '吉首',
    #     '新余',
    #     '醴陵',
    #     '47%',
    #     '呼和浩特',
    #     '涟源',
    #     '杨欢',
    #     '段杰',
    #     '海林',
    #     '顾莲',
    #     '陈昌',
    #     '严珑',
    #     '龙井',
    #     '天津',
    #     '石炭井',
    #     '余丽娜',
    #     '海城',
    #     '铁力',
    #     '秦梦',
    #     '-275%',
    #     '徐州',
    #     '临江',
    #     '沈婷',
    #     '扬州',
    #     '寿光',
    #     '薛婷',
    #     '谢斯云',
    #     '本溪',
    #     '云阳',
    #     '纸张',
    #     '青冈',
    #     '夏芯',
    #     '叶莲',
    #     '60%',
    #     '黄石',
    #     '平均值',
    #     '八面通',
    #     '陶博',
    #     '泗水',
    #     '宜宾',
    #     '许安',
    #     '贵阳',
    #     '海口',
    #     '有多少',
    #     '李黎明',
    #     '海南',
    #     '大于等于',
    #     '睢城',
    #     '和田',
    #     '辽阳',
    #     '谢聪',
    #     '薛娇',
    #     '禄步',
    #     '宝应',
    #     '顺义',
    #     '书架',
    #     '阜阳',
    #     '李莲',
    #     '六合',
    #     '甘南',
    #     '绵阳',
    #     '复印机',
    #     '凌源',
    #     '钟宣',
    #     '折扣',
    #     '廖珊',
    #     '黑山',
    #     '广西',
    #     '莱州',
    #     '王霖',
    #     '数量',
    #     '-245%',
    #     '贺鹏',
    #     '徐虹',
    #     '钱崆',
    #     '是',
    #     '彭丽雪',
    #     '杨立勤',
    #     '-18%',
    #     '辽宁',
    #     '楚伟',
    #     '-300%',
    #     '拉萨',
    #     '黄梅',
    #     '俞丹',
    #     '陈晨',
    #     '广元',
    #     '傅晨',
    #     '24%',
    #     '常丽华',
    #     '朱丽丽',
    #     '候武',
    #     '三岔子',
    #     '东海',
    #     '山亭',
    #     '-190%',
    #     '任杰',
    #     '任梅',
    #     '榆次',
    #     '贾伟',
    #     '佘平',
    #     '白松',
    #     '大庆',
    #     '太原',
    #     '陶巧',
    #     '巨野',
    #     '销售额预测',
    #     '毛丽美',
    #     '-19%',
    #     '冯立',
    #     '安埠',
    #     '-380%',
    #     '范彩',
    #     '孙谙',
    #     '徐安',
    #     '平遥',
    #     '范刚',
    #     '薛梦',
    #     '王嘉丽',
    #     '苏婵娟',
    #     '田丽美',
    #     '福建',
    #     '徐虢',
    #     '-250%',
    #     '殷菊',
    #     '丁妮',
    #     '清远',
    #     '信阳',
    #     '佘升',
    #     '肇东',
    #     '严强',
    #     '周冬露',
    #     '郝惠',
    #     '明水',
    #     '贵州',
    #     '许莞颖',
    #     '贾彩',
    #     '石家庄',
    #     '28%',
    #     '薛君',
    #     '无锡',
    #     '殷宣',
    #     '孔关茵',
    #     '山城',
    #     '马锦',
    #     '孟珊',
    #     '烟台',
    #     '马丽',
    #     '-8%',
    #     '苏家屯',
    #     '邓保',
    #     '施奇',
    #     '-100%',
    #     '平庄',
    #     '周口',
    #     '白立荣',
    #     '常黎明',
    #     '贺婵',
    #     '阳江',
    #     '41%',
    #     '21%',
    #     '吕婵娟',
    #     '贺绅',
    #     '安康',
    #     '-150%',
    #     '厦门',
    #     '>',
    #     '贾君',
    #     '肇庆',
    #     '丁蔓楚',
    #     '李康',
    #     '马莲',
    #     '白忠',
    #     '汉中',
    #     '马实',
    #     '孙荷',
    #     '承德',
    #     '戴壁',
    #     '郭冬露',
    #     '韩廉',
    #     '新疆',
    #     '林磊',
    #     '杨晨',
    #     '邓姝',
    #     '薛柏',
    #     '南昌',
    #     '夏彩',
    #     '巩晒明',
    #     '袁关茵',
    #     '田谙',
    #     '榆树',
    #     '殷康',
    #     '通辽',
    #     '程雯',
    #     '邢良',
    #     '总',
    #     '郭博',
    #     '渭南',
    #     '陈宣',
    #     '武廷',
    #     '田丽娜',
    #     '叶柏',
    #     '邢盛',
    #     '西丰',
    #     '金诚',
    #     '金华',
    #     '胶州',
    #     '洪毅',
    #     '殷保',
    #     '严聪',
    #     '徐芬',
    #     '蔡菊',
    #     '蔡安',
    #     '多少',
    #     '麦虢',
    #     '岭东',
    #     '最贵',
    #     '讷河',
    #     '韦绅',
    #     '西华',
    #     '庄菊',
    #     '王辉',
    #     '彭博',
    #     '西藏',
    #     '镇赉',
    #     '常州',
    #     '任灵',
    #     '-1%',
    #     '殷珑',
    #     '万冬露',
    #     '秦蔓楚',
    #     '黄州',
    #     '邢谦',
    #     '乐城',
    #     '郝涛',
    #     '邓秋',
    #     '塘坪',
    #     '陶盛',
    #     '莱芜',
    #     '松陵',
    #     '娄底',
    #     '美术',
    #     '登封',
    #     '田安',
    #     '坪山',
    #     '陶丽雪',
    #     '马凤',
    #     '-138%',
    #     '袁廷',
    #     '苏升',
    #     '曹伟',
    #     '赵盛',
    #     '弥阳',
    #     '陈锦',
    #     '邵杰',
    #     '唐婉',
    #     '永川',
    #     '虎石台',
    #     '最失调',
    #     '颍上城关镇',
    #     '靳刚',
    #     '高密',
    #     '俞明',
    #     '-350%',
    #     '凤城',
    #     '碣石',
    #     '-390%',
    #     '许昌',
    #     '仪征',
    #     '牛德伟',
    #     '-290%',
    #     '郭莲',
    #     '薛庆缘',
    #     '周诚',
    #     '彭安',
    #     '-90%',
    #     '常刚',
    #     '涂辉',
    #     '楚聪',
    #     '任实',
    #     '顾黎明',
    #     '袁荣',
    #     '-230%',
    #     '佟崆',
    #     '辽中',
    #     '38%',
    #     '徐谙',
    #     '曾伟',
    #     '小围寨',
    #     '谷莲',
    #     '邓实',
    #     '李蔓楚',
    #     '马坝',
    #     '栾城',
    #     '宾州',
    #     '施强',
    #     '付丽',
    #     '陕西',
    #     '海州',
    #     '徐菊',
    #     '范娜',
    #     '徐君',
    #     '徐虎',
    #     '-62%',
    #     '内蒙古',
    #     '陈嫒',
    #     '钟伟',
    #     '钟立',
    #     '唐忠',
    #     '=',
    #     '韦锦',
    #     '彭彩',
    #     '田立',
    #     '新乡',
    #     '内江',
    #     '总数',
    #     '石河子',
    #     '订单 id',
    #     '恒山',
    #     '良乡',
    #     '并且',
    #     '柳明',
    #     '武穴',
    #     '苏冬露',
    #     '胶南',
    #     '汕头',
    #     '梧州',
    #     '绥棱',
    #     '淡水',
    #     '俞蔓楚',
    #     '都匀',
    #     '44%',
    #     '梁梦',
    #     '依兰',
    #     '程德',
    #     '夏平',
    #     '图们',
    #     '中国',
    #     '咸阳',
    #     '任丘',
    #     '西乡',
    #     '廖立',
    #     '收纳具',
    #     '袁保',
    #     '巩达侠',
    #     '封乐',
    #     '巩安',
    #     '陈丽雪',
    #     '-7%',
    #     '虎门',
    #     '肖壁',
    #     '冯婷',
    #     '黄盛',
    #     '澄江',
    #     '宁阳',
    #     '彭城',
    #     '滴道',
    #     '熊宣',
    #     '付芳茵',
    #     '禹州',
    #     '何芯',
    #     '-255%',
    #     '蓬莱',
    #     '牛惠',
    #     '昆明',
    #     '韦诚',
    #     '80%',
    #     '南渡',
    #     '景洪',
    #     '胡晨',
    #     '袁临耀',
    #     '冯松',
    #     '富阳',
    #     '钦州',
    #     '贺荣',
    #     '云浮',
    #     '舒兰',
    #     '潍坊',
    #     '曾锦',
    #     '鄂州',
    #     '陶惠',
    #     '-356%',
    #     '曹诚',
    #     '边庄',
    #     '不等于',
    #     '廊坊',
    #     '潘涛',
    #     '-34%',
    #     '大连',
    #     '谭乐',
    #     '邓康',
    #     '邵武',
    #     '佘彩',
    #     '磐石',
    #     '曹冬露',
    #     '余嫒',
    #     '白欢',
    #     '麦平',
    #     '小型企业',
    #     '北京',
    #     '江都',
    #     '刘立',
    #     '南洲',
    #     '李丽丽',
    #     '椅子',
    #     '曹娜',
    #     '林谙',
    #     '郭刚',
    #     '每名客户销售额',
    #     '余晨',
    #     '白立',
    #     '陈翠',
    #     '余毅',
    #     '嘉峪关',
    #     '潘琼',
    #     '林康',
    #     '常德',
    #     '邓惠',
    #     '钱伟',
    #     '二道江',
    #     '丹江口',
    #     '袁德',
    #     '大连湾',
    #     '-261%',
    #     '徐荷',
    #     '来宾',
    #     '常君',
    #     '皇岗',
    #     '宁夏',
    #     '钱珊',
    #     '邱秋',
    #     '临朐',
    #     '德惠',
    #     '昌黎',
    #     '-175%',
    #     '日照',
    #     '南隆',
    #     '阳谷',
    #     '田丹',
    #     '顾磊',
    #     '23%',
    #     '钱珑',
    #     '熊光',
    #     '铜陵',
    #     '韩莲',
    #     '王敬',
    #     '冯青',
    #     '戴康',
    #     '安庆',
    #     '袁梅',
    #     '巩廉',
    #     '韦磊',
    #     '洪康',
    #     '-191%',
    #     '陈安',
    #     '-30%',
    #     '贺宁',
    #     '陶聪',
    #     '-130%',
    #     '中南',
    #     '原平',
    #     '田武',
    #     '刘婵',
    #     '肖崆',
    #     '吕欢悦',
    #     '福州',
    #     '配件',
    #     '-325%',
    #     '夏镇',
    #     '淮阴',
    #     '金昌',
    #     '曹欢悦',
    #     '邓黎明',
    #     '黄岩',
    #     '田磊',
    #     '-39%',
    #     '周康',
    #     '蒋冬露',
    #     '温岭',
    #     '青州',
    #     '三亚',
    #     '韩凤',
    #     '沅江',
    #     '袁平',
    #     '津市',
    #     '邓立',
    #     '准时装运',
    #     '山西',
    #     '殷莲',
    #     '-4%',
    #     '临水',
    #     '濉溪',
    #     '杨诚',
    #     '成都',
    #     '45%',
    #     '唐爽',
    #     '随州',
    #     '葛乐',
    #     '薛光',
    #     '方惠',
    #     '-20%',
    #     '阆中',
    #     '余下',
    #     '让胡路',
    #     '最强',
    #     '邓达侠',
    #     '韩丽华',
    #     '济宁',
    #     '30%',
    #     '汶上',
    #     '通州',
    #     '-355%',
    #     '贺虹',
    #     '麻城',
    #     '邱梦',
    #     '富拉尔基区',
    #     '余雯',
    #     '湘乡',
    #     '常升',
    #     '延吉',
    #     '杨健',
    #     '辉南',
    #     '-85%',
    #     '唐家庄',
    #     '中枢',
    #     '-22%',
    #     '黄雯',
    #     '西昌',
    #     '谭忠',
    #     '白锦',
    #     '宜昌',
    #     '沈彩',
    #     '邢台',
    #     '河坡',
    #     '13%',
    #     '标签',
    #     '泰兴',
    #     '曾岱',
    #     '沈聪',
    #     '贺婉',
    #     '徐婵娟',
    #     '邢伟',
    #     '-115%',
    #     '桦南',
    #     '27%',
    #     '贵溪',
    #     '昆阳',
    #     '赵芳',
    #     '马惠英',
    #     '潘雯',
    #     '椒江',
    #     '-27%',
    #     '徐健',
    #     '万虹',
    #     '熊晨',
    #     '韦实',
    #     '肖良',
    #     '陶昌',
    #     '吕丽',
    #     '苏涛',
    #     '潘丽美',
    #     '广东',
    #     '万刚',
    #     '王庆缘',
    #     '泰来',
    #     '贾丹',
    #     '安达',
    #     '-52%',
    #     '遵义',
    #     '最牛',
    #     '邹丽雪',
    #     '开远',
    #     '吴川',
    #     '施平',
    #     '白聪',
    #     '许绅',
    #     '39%',
    #     '巩凤',
    #     '青岛',
    #     '1%',
    #     '俞荷',
    #     '-31%',
    #     '瓦房店',
    #     '邱丽',
    #     '-270%',
    #     '-371%',
    #     '莆田',
    #     '普兰店',
    #     '钟忠',
    #     '廖保',
    #     '田淑芳',
    #     '蚌埠',
    #     '公主岭',
    #     '耒阳',
    #     '曾康',
    #     '柯婷',
    #     '-38%',
    #     '马荣',
    #     '浦阳',
    #     '麦德',
    #     '12%',
    #     '35%',
    #     '15%',
    #     '32%',
    #     '廖乐',
    #     '袁栋',
    #     '运城',
    #     '孟斯云',
    #     '夏松',
    #     '-365%',
    #     '浯溪',
    #     '钟庆缘',
    #     '郑州',
    #     '谭琼',
    #     '或者',
    #     '巩松',
    #     '殷昌',
    #     '德阳',
    #     '余凤',
    #     '卢芳',
    #     '苏晒明',
    #     '丹东',
    #     '孙壁',
    #     '顾升',
    #     '吉林',
    #     '贺平',
    #     '梅州',
    #     '遂宁',
    #     '徐丽丽',
    #     '浏阳',
    #     '俞毅',
    #     '定陶',
    #     '孙辉',
    #     '贺兰',
    #     '柯娜',
    #     '邱德',
    #     '钟祥',
    #     '付涛',
    #     '余婵',
    #     '张家口',
    #     '罗容',
    #     '薛立伟',
    #     '范晒明',
    #     '濮阳',
    #     '田诚',
    #     '老河口',
    #     '不超过',
    #     '办公用品',
    #     '毛保',
    #     '贾廉',
    #     '大于',
    #     '-260%',
    #     '赖聪',
    #     '彭琼',
    #     '潘凤',
    #     '邱谦',
    #     '陈惠英',
    #     '莱阳',
    #     '何安',
    #     '晋江',
    #     '五常',
    #     '常盛',
    #     '-28%',
    #     '康丽',
    #     '8%',
    #     '郭升',
    #     '-330%',
    #     '省/自治区',
    #     '南阳',
    #     '威海',
    #     '陈忠',
    #     '-49%',
    #     '常惠英',
    #     '20%',
    #     '付霖',
    #     '阳泉',
    #     '柯婵',
    #     '门头沟',
    #     '济南',
    #     '谈涛',
    #     '琼山',
    #     '忻州',
    #     '邢柏',
    #     '长治',
    #     '6%',
    #     '罗霖',
    #     '方栋',
    #     '田妮',
    #     '银川',
    #     '-346%',
    #     '子类别',
    #     '范谙',
    #     '韩虎',
    #     '各',
    #     '蔡晨',
    #     '牛黎明',
    #     '秦宁',
    #     '双鸭山',
    #     '-64%',
    #     '毛芯',
    #     '九江',
    #     '桂平',
    #     '-360%',
    #     '-42%',
    #     '钱涛',
    #     '程欢悦',
    #     '白山',
    #     '程根基',
    #     '牙克石',
    #     '齐齐哈尔',
    #     '贺锦',
    #     '-50%',
    #     '胡锦',
    #     '邵绅',
    #     '邯郸',
    #     '!=',
    #     '雷木兰',
    #     '和龙',
    #     '归仁',
    #     '尹凤',
    #     '湖北',
    #     '汤欢悦',
    #     '邵黎明',
    #     '邵娜',
    #     '施立伟',
    #     '-110%',
    #     '50%',
    #     '谭临耀',
    #     '东胜',
    #     '-376%',
    #     '义马',
    #     '葛毅',
    #     '廖松',
    #     '不低于',
    #     '深圳',
    #     '曹鹏',
    #     '甘肃',
    #     '彭虹',
    #     '邢宁',
    #     '汪清',
    #     '安顺',
    #     '严恒',
    #     '10%',
    #     '金沙',
    #     '白城',
    #     '武欢',
    #     '-2%',
    #     '谢君',
    #     '鸡东',
    #     '-15%',
    #     '电话',
    #     '9%',
    #     '绍兴',
    #     '贾柏',
    #     '佘凤',
    #     '岫岩',
    #     '邱刚',
    #     '启东',
    #     '范恒',
    #     '-225%',
    #     '涂博',
    #     '唐宁',
    #     '廉江',
    #     '荔城',
    #     '熊荣',
    #     '倪乐',
    #     '涂强',
    #     '桂林',
    #     '石马',
    #     '佛山',
    #     '嫩江',
    #     '湖南',
    #     '平均',
    #     '宋栋',
    #     '吕凤',
    #     '卢爽',
    #     '俞平',
    #     '>=',
    #     '曾惠',
    #     '最高',
    #     '-24%',
    #     '文登',
    #     '倪爽',
    #     '禹城',
    #     '叶琪',
    #     '七台河',
    #     '四平',
    #     '武磊',
    #     '技术',
    #     '程蔓楚',
    #     '密山',
    #     '西安',
    #     '南宫',
    #     '肇源',
    #     '-400%',
    #     '常宣',
    #     '恩施',
    #     '辽源',
    #     '商丘',
    #     '徐岱',
    #     '化州',
    #     '黄岱',
    #     '开通',
    #     '彭婉',
    #     '唐山',
    #     '石嘴山',
    #     '巩嫒',
    #     '夏娜',
    #     '邹妮',
    #     '黄婷',
    #     '秦皇岛',
    #     '罗嫒',
    #     '上梅',
    #     '剑光',
    #     '李彩',
    #     '蔡梦',
    #     '华北',
    #     '汉沽',
    #     '贾保',
    #     '明月',
    #     '4%',
    #     '何虢',
    #     '邢德伟',
    #     '阿克苏',
    #     '夏梦',
    #     '陶德伟',
    #     '永丰',
    #     '曹达侠',
    #     '邱升',
    #     '高州',
    #     '唐木兰',
    #     '-280%',
    #     '柯强',
    #     '去重计数',
    #     '玉林',
    #     '刘斯云',
    #     '发货日期',
    #     '林德伟',
    #     '-16%',
    #     '黄娜',
    #     '桌子',
    #     '殷凤',
    #     '兴城',
    #     '丁君',
    #     '蒋安',
    #     '陈立',
    #     '龚松',
    #     '宜春',
    #     '罗君',
    #     '17%',
    #     '开封',
    #     '界首',
    #     '山河屯',
    #     '任临耀',
    #     '严盛',
    #     '重庆',
    #     '万莞颖',
    #     '呼兰',
    #     '丁武',
    #     '小于',
    #     '赵德伟',
    #     '18%',
    #     '唐寨',
    #     '南岔',
    #     '东台',
    #     '万兰',
    #     '集宁',
    #     '-316%',
    #     '方蔓楚',
    #     '梨树',
    #     '俞晒明',
    #     '杭州',
    #     '郝立',
    #     '-143%',
    #     '贺伟',
    #     '-305%',
    #     '-148%',
    #     '青海',
    #     '洪华',
    #     '丰县',
    #     '-215%',
    #     '施梦',
    #     '薛博',
    #     '双城',
    #     '咸水沽',
    #     '佘莲',
    #     '蒋光',
    #     '余舟',
    #     '陈虎',
    #     '罗城',
    #     '平均数',
    #     '田江丽',
    #     '郝立勤',
    #     '宋忠',
    #     '牡丹江',
    #     '小',
    #     '顾君',
    #     '洪强',
    #     '枝江',
    #     '前郭',
    #     '涂德伟',
    #     '侯虹',
    #     '薛强',
    #     '-345%',
    #     '黑龙江',
    #     '塔河',
    #     '-11%',
    #     '最小',
    #     '家具',
    #     '黎城',
    #     '涂丽',
    #     '不同',
    #     '东营',
    #     '肖菊',
    #     '曹灵',
    #     '施丽丽',
    #     '贾松',
    #     '丰镇',
    #     '大冶',
    #     '莘县',
    #     '晋城',
    #     '-370%',
    #     '任婵娟',
    #     '巩虢',
    #     '-78%',
    #     '麦实',
    #     '最弱',
    #     '肖冬露',
    #     '富锦',
    #     '宋立',
    #     '谢雯',
    #     '黄涛',
    #     '彭雯',
    #     '益阳',
    #     '韦达侠',
    #     '-33%',
    #     '枣阳',
    #     '西南',
    #     '-285%',
    #     '锡林浩特',
    #     '最低',
    #     '付聪',
    #     '26%',
    #     '梁婵娟',
    #     '秦黎明',
    #     '唐栋',
    #     '胡凤',
    #     '范宁',
    #     '吕关茵',
    #     '孟刚',
    #     '31%',
    #     '薛磊',
    #     '毛升',
    #     '佟虹',
    #     '贾芳茵',
    #     '-320%',
    #     '湘潭',
    #     '用品',
    #     '宁波',
    #     '潘彩',
    #     '临沂',
    #     '巩珑',
    #     '订单日期',
    #     '-3%',
    #     '施旺',
    #     '鹤岗',
    #     '怀城',
    #     '周村',
    #     '天长',
    #     '施菊',
    #     '-55%',
    #     '江油',
    #     '尚志',
    #     '秦刚',
    #     '严诚',
    #     '德州',
    #     '淮南',
    #     '韩莞颖',
    #     '沂水',
    #     '阳春',
    #     '最没用',
    #     '谭涛',
    #     '大理',
    #     '潘荷',
    #     '曲阜',
    #     '衡阳',
    #     '沧州',
    #     '田良',
    #     '武廉',
    #     '邵彩',
    #     '夏柏',
    #     '郝升',
    #     '徐嘉丽',
    #     '\ufeff发货前天数（实际）',
    #     '惠城',
    #     '湛江',
    #     '宁海',
    #     '江门',
    #     '-306%',
    #     '临海',
    #     '平南',
    #     '杨村',
    #     '松江河',
    #     '卢壁',
    #     '钱幂',
    #     '白斯云',
    #     '洪黎明',
    #     '潘莞颖',
    #     '蒲庙',
    #     '16%',
    #     '马盛',
    #     '-68%',
    #     '楚虢',
    #     '唐安',
    #     '谭珊',
    #     '许娜',
    #     '佘虢',
    #     '龙口',
    #     '江西',
    #     '郝柏',
    #     '佳木斯',
    #     '黄芳',
    #     '袁丽华',
    #     '49%',
    #     '-21%',
    #     '塘沽',
    #     '株洲',
    #     '孔松',
    #     '安丘',
    #     '-310%',
    #     '冷水滩',
    #     '孟虢',
    #     '提前装运',
    #     '庄丹',
    #     '细分',
    #     '冯丽丽',
    #     '丽水',
    #     '邢毅',
    #     '邳州',
    #     '冯莲',
    #     '辛集',
    #     '薛武',
    #     '邹涛',
    #     '林关茵',
    #     '佘宁',
    #     '黎雯',
    #     '康娇',
    #     '叶实',
    #     '姚彩',
    #     '姜堰',
    #     '龙婷',
    #     '29%',
    #     '龙廷',
    #     '许凤',
    #     '夏惠英',
    #     '丁婵',
    #     '余德',
    #     '或',
    #     '巩明媚',
    #     '熊丽',
    #     '高凤',
    #     '洛阳',
    #     '楚娟',
    #     '西宁',
    #     '长沙',
    #     '彭伟',
    #     '陈爽',
    #     '楚宣',
    #     '怀化',
    #     '-155%',
    #     '东莞',
    #     '扶余',
    #     '郴州',
    #     '记录数',
    #     '-40%',
    #     '虢镇',
    #     '秦君',
    #     '邵伟',
    #     '陈娟',
    #     '客户名称',
    #     '-216%',
    #     '陶虢',
    #     '曹丽娜',
    #     '铁岭',
    #     '袁松',
    #     '邢立荣',
    #     '淮北',
    #     '哈尔滨',
    #     '何晨',
    #     '-43%',
    #     '庄河',
    #     '何惠',
    #     '赵强',
    #     '赵婵',
    #     '襄城',
    #     '韦华',
    #     '姚凤',
    #     '吕灵',
    #     '-35%',
    #     '付惠',
    #     '最大',
    #     '付松',
    #     '-161%',
    #     '40%',
    #     '威宁',
    #     '-5%',
    #     '-45%',
    #     '龙泉',
    #     '镇江',
    #     '唐蔓楚',
    #     '白德伟',
    #     '东村',
    #     '徐关茵',
    #     '徐黎明',
    #     '合肥',
    #     '山东',
    #     '超过',
    #     '荆门',
    #     '曾幂',
    #     '延迟装运',
    #     '邱明',
    #     '李谙',
    #     '徐莲',
    #     '楚松',
    #     '-10%',
    #     '杨德伟',
    #     '滁州',
    #     '苏磊',
    #     '珲春',
    #     '-133%',
    #     '陈莲',
    #     '敦化',
    #     '长春',
    #     '罗平',
    #     '19%',
    #     '南充',
    #     '聊城',
    #     '陈磊',
    #     '泉州',
    #     '潘谙',
    #     '类别',
    #     '浙江',
    #     '殷丽雪',
    #     '贺舟',
    #     '地区',
    #     '设备',
    #     '戴虎',
    #     '兴化',
    #     '溪美',
    #     '新泰',
    #     '许根基',
    #     '最多',
    #     '枣庄',
    #     '孟伟',
    #     '沈光',
    #     '-375%',
    #     '林凤',
    #     '景德镇',
    #     '梁安',
    #     '揭阳',
    #     '池州',
    #     '汕尾',
    #     '秦诚',
    #     '东宁',
    #     '-9%',
    #     '利川',
    #     '器具',
    #     '潘舟',
    #     '-185%',
    #     '丰润',
    #     '彭绅',
    #     '望奎',
    #     '鹿城',
    #     '招远',
    #     '田临耀',
    #     '邵兰',
    #     '朝阳',
    #     '范雯',
    #     '-14%',
    #     '佘巧',
    #     '袁康']
    # nlp.update_index(key_words, "zh_CN")
    # print(nlp.segment("1999年到2005年的城镇人口", "zh_CN"))
    # print(nlp.segment("各省份的总人口有多少", "zh_CN"))
    # key_words = [
    #     '>=',
    #     'single',
    #     'last_call_duration',
    #     '<',
    #     'last_number_of_calls',
    #     'month',
    #     'no',
    #     'most',
    #     'divorced',
    #     'services',
    #     'is',
    #     'by',
    #     'nov',
    #     'least popular',
    #     'lowest',
    #     'thu',
    #     'less or equal',
    #     'smallest',
    #     'retired',
    #     '>',
    #     'total',
    #     'management',
    #     'less',
    #     'dec',
    #     'greater or equal',
    #     'most popular',
    #     'this_number_of_calls',
    #     'le',
    #     'success',
    #     'minimum',
    #     'maximum',
    #     'married',
    #     'sum',
    #     'job',
    #     'more',
    #     'less than',
    #     '=',
    #     'equal or lesser than',
    #     'worst',
    #     'each',
    #     'more than',
    #     'max',
    #     'greater or equal to',
    #     'the most',
    #     'yes',
    #     'ge',
    #     'technician',
    #     'mar',
    #     '!=',
    #     'sep',
    #     'cellular',
    #     'at least',
    #     'nonexistent',
    #     'bottom',
    #     'aug',
    #     'basic 6y',
    #     'high school',
    #     'person_loan',
    #     'and',
    #     'grouped by',
    #     'mean',
    #     'or',
    #     'is equal or lesser',
    #     'least',
    #     'equal',
    #     'education',
    #     'how many',
    #     'mon',
    #     'not equal to',
    #     'unknown',
    #     'youngest',
    #     'by each',
    #     'interval',
    #     'less than or equal to',
    #     'entrepreneur',
    #     'number of',
    #     'wed',
    #     'equal or lesser',
    #     'different count',
    #     'blue collar',
    #     'highest',
    #     'communication_mode',
    #     'student',
    #     'at most',
    #     'greater than or equal',
    #     'apr',
    #     'count',
    #     'is equal or lesser than',
    #     'best',
    #     'top',
    #     'less than or equal',
    #     'may',
    #     'for each',
    #     'group by',
    #     'age',
    #     'amount of',
    #     'professional course',
    #     'basic 9y',
    #     'self employed',
    #     'house_loan',
    #     'leading',
    #     'fri',
    #     'the total of',
    #     'tue',
    #     'unemployed',
    #     'jul',
    #     'result',
    #     'not equal',
    #     'average',
    #     'id',
    #     'oct',
    #     'min',
    #     'in each',
    #     'marital',
    #     'per',
    #     'housemaid',
    #     'less or equal to',
    #     'credit_problem',
    #     'admin.',
    #     'basic 4y',
    #     'jun',
    #     'largest',
    #     'euqal to',
    #     'university degree',
    #     'illiterate',
    #     'outcome',
    #     '<=',
    #     'greater than or equal to',
    #     'telephone',
    #     'day_of_week',
    #     'every',
    #     'failure',
    #     'foreach',
    #     'avg']
    # # nlp.update_index(["the total of", "average", "the sum of", "blue collar", "age"], "en_US")
    # nlp.update_index(key_words, "en_US")
    # print(nlp.segment("age of blue collar"))
    # print(nlp.segment("show the count of average people. the sum of it too"))
    # nlp.update_index(['singer_id',
    #                   'name',
    #                   'country',
    #                   'song_name',
    #                   'year',
    #                   'age',
    #                   'is_male',
    #                   'more than',
    #                   'less than',
    #                   'is',
    #                   'and',
    #                   'or',
    #                   'each',
    #                   'every',
    #                   'the total of',
    #                   'sum',
    #                   'average',
    #                   'avg',
    #                   'different count',
    #                   'count',
    #                   'max',
    #                   'maximum',
    #                   'most',
    #                   'the most',
    #                   'min',
    #                   'minimum',
    #                   'youngest'],
    #                  "en_US")
    # print(nlp.segment("show the max age where age more than 10 in China"))


    key_words = ['辽宁省', '这你水发电量', 'avg', '重庆市', 'minimum', 'least', '<=', '广西壮族自治区', '<', '河北省', 'is equal', '西藏自治区', 'per', '太阳能发电量_当期值(万千瓦时)', 'less than or equal', '甘肃省', 'less or equal', 'greater than or equal', 'equal', 'foreach', 'average', '江苏省', 'min', '山东省', '贵州省', '地区', 'more than', 'count of different', '火力发电量_当期值(亿千瓦时)', 'the total of', 'mean', 'the most', '核能发电量_当期值(亿千瓦时)', 'less', 'in each', '发电量_当期值(亿千瓦时)', 'for each', 'bottom', '安徽省', '湖南省', 'is', 'youngest', 'sum', 'grouped by', 'equal or lesser than', 'ge', 'max', 'every', '福建省', '黑龙江省', '北京市', 'and', '河南省', 'is equal or lesser than', 'equal or lesser', 'greater than or equal to', 'at most', '上海市', 'greater or equal', '青海省', 'more', '风力发电量_当期值(亿千瓦时)', '>=', '吉林省', 'worst', 'largest', 'or', '湖北省', 'not equal', 'less than', 'at least', 'less or equal to', '陕西省', '>', 'count', '宁夏回族自治区', '天津市', '内蒙古自治区', '新疆维吾尔自治区', '日期', 'top', 'leading', 'each', 'number of', 'less than or equal to', 'amount of', 'greater or equal to', '江西省', 'group by', 'smallest', 'most popular', '海南省', 'lowest', 'most', 'not equal to', '浙江省', 'maximum', 'is equal to', 'le', '四川省', 'is equal or lesser', 'least popular', '云南省', 'different count', '山西省', 'by', 'the worst', 'how many', 'best', 'by each', 'total', '广东省', '!=', '=', 'highest', 'equal to']
    nlp.update_index(key_words)
    # print(nlp.indexs)
    print(nlp.segment("北京市的这你水发电量"))
